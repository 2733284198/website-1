define("components/jashkenas/backbone/backbone",["underscore","jashkenas/underscore","components/jquery"],function(t,e){(function(){var n,i=this,r=i.Backbone,o=[],s=o.push,a=o.slice,l=o.splice;n="undefined"!==typeof e?e:i.Backbone={};n.VERSION="1.0.0";var u=i._;u||"undefined"===typeof t||(u=t("underscore"));n.$=i.jQuery||i.Zepto||i.ender||i.$;n.noConflict=function(){i.Backbone=r;return this};n.emulateHTTP=!1;n.emulateJSON=!1;var c=n.Events={on:function(t,e,n){if(!p(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);i.push({callback:e,context:n,ctx:n||this});return this},once:function(t,e,n){if(!p(this,"once",t,[e,n])||!e)return this;var i=this,r=u.once(function(){i.off(t,r);e.apply(this,arguments)});r._callback=e;return this.on(t,r,n)},off:function(t,e,n){var i,r,o,s,a,l,c,h;if(!this._events||!p(this,"off",t,[e,n]))return this;if(!t&&!e&&!n){this._events={};return this}s=t?[t]:u.keys(this._events);for(a=0,l=s.length;a<l;a++){t=s[a];if(o=this._events[t]){this._events[t]=i=[];if(e||n)for(c=0,h=o.length;c<h;c++){r=o[c];(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r)}i.length||delete this._events[t]}}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!p(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;n&&f(n,e);i&&f(i,arguments);return this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r=!e&&!n;"object"===typeof e&&(n=this);t&&((i={})[t._listenerId]=t);for(var o in i){i[o].off(e,n,this);r&&delete this._listeners[o]}return this}},h=/\s+/,p=function(t,e,n,i){if(!n)return!0;if("object"===typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(h.test(n)){for(var o=n.split(h),s=0,a=o.length;s<a;s++)t[e].apply(t,[o[s]].concat(i));return!1}return!0},f=function(t,e){var n,i=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}},d={listenTo:"on",listenToOnce:"once"};u.each(d,function(t,e){c[e]=function(e,n,i){var r=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=u.uniqueId("l"));r[o]=e;"object"===typeof n&&(i=this);e[t](n,i,this);return this}});c.bind=c.on;c.unbind=c.off;u.extend(n,c);var v=n.Model=function(t,e){var n,i=t||{};e||(e={});this.cid=u.uniqueId("c");this.attributes={};u.extend(this,u.pick(e,g));e.parse&&(i=this.parse(i,e)||{});(n=u.result(this,"defaults"))&&(i=u.defaults({},i,n));this.set(i,e);this.changed={};this.initialize.apply(this,arguments)},g=["url","urlRoot","collection"];u.extend(v.prototype,c,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return u.clone(this.attributes)},sync:function(){return n.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return u.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r,o,s,a,l,c,h;if(null==t)return this;if("object"===typeof t){r=t;n=e}else(r={})[t]=e;n||(n={});if(!this._validate(r,n))return!1;o=n.unset;a=n.silent;s=[];l=this._changing;this._changing=!0;if(!l){this._previousAttributes=u.clone(this.attributes);this.changed={}}h=this.attributes,c=this._previousAttributes;this.idAttribute in r&&(this.id=r[this.idAttribute]);for(i in r){e=r[i];u.isEqual(h[i],e)||s.push(i);u.isEqual(c[i],e)?delete this.changed[i]:this.changed[i]=e;o?delete h[i]:h[i]=e}if(!a){s.length&&(this._pending=!0);for(var p=0,f=s.length;p<f;p++)this.trigger("change:"+s[p],this,h[s[p]],n)}if(l)return this;if(!a)for(;this._pending;){this._pending=!1;this.trigger("change",this,n)}this._pending=!1;this._changing=!1;return this},unset:function(t,e){return this.set(t,void 0,u.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,u.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!u.isEmpty(this.changed):u.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?u.clone(this.changed):!1;var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in t)u.isEqual(i[r],e=t[r])||((n||(n={}))[r]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(t){t=t?u.clone(t):{};void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;t.success=function(i){if(!e.set(e.parse(i,t),t))return!1;n&&n(e,i,t);e.trigger("sync",e,i,t)};R(this,t);return this.sync("read",this,t)},save:function(t,e,n){var i,r,o,s=this.attributes;if(null==t||"object"===typeof t){i=t;n=e}else(i={})[t]=e;if(i&&(!n||!n.wait)&&!this.set(i,n))return!1;n=u.extend({validate:!0},n);if(!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=u.extend({},s,i));void 0===n.parse&&(n.parse=!0);var a=this,l=n.success;n.success=function(t){a.attributes=s;var e=a.parse(t,n);n.wait&&(e=u.extend(i||{},e));if(u.isObject(e)&&!a.set(e,n))return!1;l&&l(a,t,n);a.trigger("sync",a,t,n)};R(this,n);r=this.isNew()?"create":n.patch?"patch":"update";"patch"===r&&(n.attrs=i);o=this.sync(r,this,n);i&&n.wait&&(this.attributes=s);return o},destroy:function(t){t=t?u.clone(t):{};var e=this,n=t.success,i=function(){e.trigger("destroy",e,e.collection,t)};t.success=function(r){(t.wait||e.isNew())&&i();n&&n(e,r,t);e.isNew()||e.trigger("sync",e,r,t)};if(this.isNew()){t.success();return!1}R(this,t);var r=this.sync("delete",this,t);t.wait||i();return r},url:function(){var t=u.result(this,"urlRoot")||u.result(this.collection,"url")||I();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},u.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=u.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;if(!n)return!0;this.trigger("invalid",this,n,u.extend(e||{},{validationError:n}));return!1}});var m=["keys","values","pairs","invert","pick","omit"];u.each(m,function(t){v.prototype[t]=function(){var e=a.call(arguments);e.unshift(this.attributes);return u[t].apply(u,e)}});var y=n.Collection=function(t,e){e||(e={});e.url&&(this.url=e.url);e.model&&(this.model=e.model);void 0!==e.comparator&&(this.comparator=e.comparator);this._reset();this.initialize.apply(this,arguments);t&&this.reset(t,u.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},w={add:!0,merge:!1,remove:!1};u.extend(y.prototype,c,{model:v,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return n.sync.apply(this,arguments)},add:function(t,e){return this.set(t,u.defaults(e||{},w))},remove:function(t,e){t=u.isArray(t)?t.slice():[t];e||(e={});var n,i,r,o;for(n=0,i=t.length;n<i;n++){o=this.get(t[n]);if(o){delete this._byId[o.id];delete this._byId[o.cid];r=this.indexOf(o);this.models.splice(r,1);this.length--;if(!e.silent){e.index=r;o.trigger("remove",o,this,e)}this._removeReference(o)}}return this},set:function(t,e){e=u.defaults(e||{},b);e.parse&&(t=this.parse(t,e));u.isArray(t)||(t=t?[t]:[]);var n,i,r,o,a,c=e.at,h=this.comparator&&null==c&&e.sort!==!1,p=u.isString(this.comparator)?this.comparator:null,f=[],d=[],v={};for(n=0,i=t.length;n<i;n++)if(r=this._prepareModel(t[n],e))if(o=this.get(r)){e.remove&&(v[o.cid]=!0);if(e.merge){o.set(r.attributes,e);h&&!a&&o.hasChanged(p)&&(a=!0)}}else if(e.add){f.push(r);r.on("all",this._onModelEvent,this);this._byId[r.cid]=r;null!=r.id&&(this._byId[r.id]=r)}if(e.remove){for(n=0,i=this.length;n<i;++n)v[(r=this.models[n]).cid]||d.push(r);d.length&&this.remove(d,e)}if(f.length){h&&(a=!0);this.length+=f.length;null!=c?l.apply(this.models,[c,0].concat(f)):s.apply(this.models,f)}a&&this.sort({silent:!0});if(e.silent)return this;for(n=0,i=f.length;n<i;n++)(r=f[n]).trigger("add",r,this,e);a&&this.trigger("sort",this,e);return this},reset:function(t,e){e||(e={});for(var n=0,i=this.models.length;n<i;n++)this._removeReference(this.models[n]);e.previousModels=this.models;this._reset();this.add(t,u.extend({silent:!0},e));e.silent||this.trigger("reset",this,e);return this},push:function(t,e){t=this._prepareModel(t,e);this.add(t,u.extend({at:this.length},e));return t},pop:function(t){var e=this.at(this.length-1);this.remove(e,t);return e},unshift:function(t,e){t=this._prepareModel(t,e);this.add(t,u.extend({at:0},e));return t},shift:function(t){var e=this.at(0);this.remove(e,t);return e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return u.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw Error("Cannot sort a set without a comparator");t||(t={});u.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this));t.silent||this.trigger("sort",this,t);return this},sortedIndex:function(t,e,n){e||(e=this.comparator);var i=u.isFunction(e)?e:function(t){return t.get(e)};return u.sortedIndex(this.models,t,i,n)},pluck:function(t){return u.invoke(this.models,"get",t)},fetch:function(t){t=t?u.clone(t):{};void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t);e&&e(n,i,t);n.trigger("sync",n,i,t)};R(this,t);return this.sync("read",this,t)},create:function(t,e){e=e?u.clone(e):{};if(!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,i=e.success;e.success=function(r){e.wait&&n.add(t,e);i&&i(t,r,e)};t.save(null,e);return t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(t,e){if(t instanceof v){t.collection||(t.collection=this);return t}e||(e={});e.collection=this;var n=new this.model(t,e);if(!n._validate(t,e)){this.trigger("invalid",this,t,e);return!1}return n},_removeReference:function(t){this===t.collection&&delete t.collection;t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if("add"!==t&&"remove"!==t||n===this){"destroy"===t&&this.remove(e,i);if(e&&t==="change:"+e.idAttribute){delete this._byId[e.previous(e.idAttribute)];null!=e.id&&(this._byId[e.id]=e)}this.trigger.apply(this,arguments)}}});var $=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each($,function(t){y.prototype[t]=function(){var e=a.call(arguments);e.unshift(this.models);return u[t].apply(u,e)}});var _=["groupBy","countBy","sortBy"];u.each(_,function(t){y.prototype[t]=function(e,n){var i=u.isFunction(e)?e:function(t){return t.get(e)};return u[t](this.models,i,n)}});var x=n.View=function(t){this.cid=u.uniqueId("view");this._configure(t||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},E=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];u.extend(x.prototype,c,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(t,e){this.$el&&this.undelegateEvents();this.$el=t instanceof n.$?t:n.$(t);this.el=this.$el[0];e!==!1&&this.delegateEvents();return this},delegateEvents:function(t){if(!t&&!(t=u.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];u.isFunction(n)||(n=this[t[e]]);if(n){var i=e.match(E),r=i[1],o=i[2];n=u.bind(n,this);r+=".delegateEvents"+this.cid;""===o?this.$el.on(r,n):this.$el.on(r,o,n)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(t){this.options&&(t=u.extend({},u.result(this,"options"),t));u.extend(this,u.pick(t,C));this.options=t},_ensureElement:function(){if(this.el)this.setElement(u.result(this,"el"),!1);else{var t=u.extend({},u.result(this,"attributes"));this.id&&(t.id=u.result(this,"id"));this.className&&(t["class"]=u.result(this,"className"));var e=n.$("<"+u.result(this,"tagName")+">").attr(t);this.setElement(e,!1)}}});n.sync=function(t,e,i){var r=k[t];u.defaults(i||(i={}),{emulateHTTP:n.emulateHTTP,emulateJSON:n.emulateJSON});var o={type:r,dataType:"json"};i.url||(o.url=u.result(e,"url")||I());if(null==i.data&&e&&("create"===t||"update"===t||"patch"===t)){o.contentType="application/json";o.data=JSON.stringify(i.attrs||e.toJSON(i))}if(i.emulateJSON){o.contentType="application/x-www-form-urlencoded";o.data=o.data?{model:o.data}:{}}if(i.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST";i.emulateJSON&&(o.data._method=r);var s=i.beforeSend;i.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",r);return s?s.apply(this,arguments):void 0}}"GET"===o.type||i.emulateJSON||(o.processData=!1);"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=n.ajax(u.extend(o,i));e.trigger("request",e,a,i);return a};var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};n.ajax=function(){return n.$.ajax.apply(n.$,arguments)};var T=n.Router=function(t){t||(t={});t.routes&&(this.routes=t.routes);this._bindRoutes();this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,S=/(\(\?)?:\w+/g,j=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(T.prototype,c,{initialize:function(){},route:function(t,e,i){u.isRegExp(t)||(t=this._routeToRegExp(t));if(u.isFunction(e)){i=e;e=""}i||(i=this[e]);var r=this;n.history.route(t,function(o){var s=r._extractParameters(t,o);i&&i.apply(r,s);r.trigger.apply(r,["route:"+e].concat(s));r.trigger("route",e,s);n.history.trigger("route",r,e,s)});return this},navigate:function(t,e){n.history.navigate(t,e);return this},_bindRoutes:function(){if(this.routes){this.routes=u.result(this,"routes");for(var t,e=u.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){t=t.replace(O,"\\$&").replace(A,"(?:$1)?").replace(S,function(t,e){return e?t:"([^/]+)"}).replace(j,"(.*?)");return RegExp("^"+t+"$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return u.map(n,function(t){return t?decodeURIComponent(t):null})}});var F=n.History=function(){this.handlers=[];u.bindAll(this,"checkUrl");if("undefined"!==typeof window){this.location=window.location;this.history=window.history}},D=/^[#\/]|\s+$/g,V=/^\/+|\/+$/g,L=/msie [\w.]+/,N=/\/$/;F.started=!1;u.extend(F.prototype,c,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var n=this.root.replace(N,"");t.indexOf(n)||(t=t.substr(n.length))}else t=this.getHash();return t.replace(D,"")},start:function(t){if(F.started)throw Error("Backbone.history has already been started");F.started=!0;this.options=u.extend({},{root:"/"},this.options,t);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==!1;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment(),i=document.documentMode,r=L.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(V,"/");if(r&&this._wantsHashChange){this.iframe=n.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(e)}this._hasPushState?n.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?n.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=e;var o=this.location,s=o.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s){this.fragment=this.getFragment(null,!0);this.location.replace(this.root+this.location.search+"#"+this.fragment);return!0}if(this._wantsPushState&&this._hasPushState&&s&&o.hash){this.fragment=this.getHash().replace(D,"");this.history.replaceState({},document.title,this.root+this.fragment+o.search)}return this.options.silent?void 0:this.loadUrl()},stop:function(){n.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);F.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=u.any(this.handlers,function(t){if(t.route.test(e)){t.callback(e);return!0}});return n},navigate:function(t,e){if(!F.started)return!1;e&&e!==!0||(e={trigger:e});t=this.getFragment(t||"");if(this.fragment!==t){this.fragment=t;var n=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace);if(this.iframe&&t!==this.getFragment(this.getHash(this.iframe))){e.replace||this.iframe.document.open().close();this._updateHash(this.iframe.location,t,e.replace)}}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}});n.history=new F;var P=function(t,e){var n,i=this;n=t&&u.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)};u.extend(n,i,e);var r=function(){this.constructor=n};r.prototype=i.prototype;n.prototype=new r;t&&u.extend(n.prototype,t);n.__super__=i.prototype;return n};v.extend=y.extend=T.extend=x.extend=F.extend=P;var I=function(){throw Error('A "url" property or function must be specified')},R=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e);t.trigger("error",t,i,e)}}}).call(this)});